{"version":3,"sources":["mibici-edit.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"mibici-edit.js","sourcesContent":["var map;\r\nvar geocoder;\r\nvar stepDisplay;\r\n\r\nvar idMarker; // TO DELETE\r\n\r\n//var list;\r\nvar active;\r\nvar refList;\r\n\r\nfunction initialize() \r\n{\r\n  var myLatLng = new google.maps.LatLng( 20.67, -103.349609);\r\n\r\n  var mapOptions = \r\n  {\r\n\r\n    zoom: 13,\r\n    center: myLatLng,\r\n    disableDoubleClickZoom: true,\r\n    mapTypeId: google.maps.MapTypeId.TERRAIN,\r\n    styles: [\r\n      {\r\n        \"featureType\": \"poi\",\r\n        stylers: [\r\n          { hue: \"#E6CCFF\" },\r\n          { saturation: -40 },\r\n          { lightness: -20 },\r\n          { gamma: 1.51 }\r\n        ]\r\n      }\r\n    ]\r\n    \r\n  };\r\n\r\n  map = new google.maps.Map(document.getElementById('map'), mapOptions);\r\n  geocoder = new google.maps.Geocoder();\r\n  stepDisplay = new google.maps.InfoWindow();\r\n\r\n    $.ajax(\r\n    {\r\n        url : '/getAll',\r\n        type: \"GET\",\r\n        success:function(data) \r\n        {\r\n          active = false;\r\n\r\n          console.log(data);\r\n          data.forEach(function(item)\r\n          {\r\n            console.log(item);\r\n              var myLatLng = new google.maps.LatLng(item.latitude,item.longitude);\r\n\r\n              var marker = new google.maps.Marker\r\n              ({\r\n                position: myLatLng,\r\n                icon: '/images/mibici.svg',\r\n                label: \"\",\r\n                map: map,\r\n                draggable: false,\r\n                title: item.description,\r\n                myData: item.id,\r\n                //animation: google.maps.Animation.DROP,\r\n                \r\n              });\r\n\r\n              google.maps.event.addListener(marker, \"click\", function (event) \r\n              {\r\n                document.getElementById('name').value = this.title;\r\n                getAddress(this.position, this.title, this.myData);\r\n\r\n                map.setCenter(this.getPosition());\r\n                map.setZoom(16);\r\n\r\n              });\r\n\r\n              google.maps.event.addListener(marker, \"dblclick\", function (event) \r\n              { \r\n                document.getElementById('name').value = this.title;\r\n                getAddress(this.position, this.title, this.myData);\r\n\r\n                map.setCenter(this.getPosition());\r\n                map.setZoom(16);\r\n\r\n                if(!this.getDraggable())\r\n                {\r\n                  if(active == false)\r\n                  if(confirm('Editar?'))\r\n                  {\r\n                    active = true;\r\n                    // becomes Draggable\r\n                    this.setDraggable(true);\r\n                    // changes icon\r\n                    this.setIcon('/images/mibici-update.svg');\r\n\r\n                    google.maps.event.addListener(marker, \"dragend\", function (event) \r\n                    {\r\n                      getAddress(this.position, this.title, this.myData);\r\n                    });\r\n\r\n                  }\r\n                }\r\n\r\n              });\r\n          }\r\n          );\r\n        },\r\n        error: function(jqXHR, textStatus, errorThrown) \r\n        {\r\n            //if fails      \r\n        }\r\n    });\r\n}\r\n\r\nfunction getAddress(latLng, title, myData)\r\n{\r\n\r\n  idMarker = myData;\r\n  document.getElementById('id').value = idMarker;\r\n\r\n  geocoder.geocode\r\n  ({\r\n    latLng: latLng\r\n  }, \r\n  function(responses) \r\n  {\r\n    if (responses && responses.length > 0)\r\n    {      \r\n\r\n          document.getElementById('markerFromAddress').value = responses[0].formatted_address;  \r\n          document.getElementById('markerFromLat').value = latLng.lat();\r\n          document.getElementById('markerFromLang').value = latLng.lng();\r\n    }\r\n    else\r\n    {\r\n      document.getElementById('markerFromAddress').value = 'Cannot determine address at this location.';\r\n    }\r\n  });\r\n}\r\n\r\n\r\ngoogle.maps.event.addDomListener(window, 'load', initialize);\r\n\r\n"]}